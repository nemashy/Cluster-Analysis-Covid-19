---
title: "Assignment1"
author: "Nyasha Mashanda"
date: "9/15/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
if(!require(readxl)) install.packages("readxl", repos = "http://cran.us.r-project.org")
if(!require(cluster)) install.packages("cluster", repos = "http://cran.us.r-project.org")
if(!require(NbClust)) install.packages("NbClust", repos = "http://cran.us.r-project.org")
if(!require(fpc)) install.packages("fpc", repos = "http://cran.us.r-project.org")
if(!require(mice)) install.packages("mice", repos = "http://cran.us.r-project.org")
if(!require(VIM)) install.packages("VIM", repos = "http://cran.us.r-project.org")

```

```{r}
df1 <- read_excel("owid-covid-data.xlsx", sheet = "Data")
visdat::vis_miss(df1)

str(df1)
```

```{r}
missing_row_values <- sum(!complete.cases(df1))
nrow(df1)
missing_row_values
```
There are 163 rows out of 208 with missing values, therefore simply dismissing rows with missing data will lead to a great loss of valuable information.

```{r}
summary(df1)
```


```{r}
aggr_plot <- VIM::aggr(df1, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(df1), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"))
```
The results show that handwashing_facilites is missing 56.25% of the values followed by extreme_poverty missing 42.3% of the values. In total, 78.4% of the samples have missing values.

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
# tempData <- mice::mice(df1,m=5,maxit=50, method='cart', seed=500)
# summary(tempData)
save(tempData, file = "replaced_missing_data.RData")
load("replaced_missing_data.RData")

```

```{r}
mice::densityplot(tempData)
mice::stripplot(tempData, pch = 20, cex = 1.2)
```

```{r}
completedData <- mice::complete(tempData, 2)
View(completedData)
visdat::vis_miss(completedData)
str(completedData)
unique(completedData$date)
test = completedData[,c(-2,-3,-4)]
rownames(test) <- test$location
test = test[,-1]
```

```{r}
# K-means clustering
set.seed(123)
km.out <- kmeans(test, 6, nstart = 25)
# k-means group number of each observation
head(km.out$cluster)

```

```{r}
# Compute pairewise distance matrices
dist.out <- dist(test, method = "euclidean")
# Hierarchical clustering results
hc <- hclust(dist.out, method = "complete")
# Visualization of hclust
plot(hc, labels = F,-1)
# 
rect.hclust(hc, k = 6, border = 2:3)
```

```{r}
hcd <- as.dendrogram(hc)
# Define nodePar
nodePar <- list(lab.cex = 0.6, pch = c(20, 19),
                cex = 0.7, col = c("green","yellow"))
plot(hcd,  xlab = "Height", nodePar = nodePar, main = "Cluster dendrogram",
     edgePar = list(col = c("red","blue"), lwd = 2:1), horiz = TRUE)
```


## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
